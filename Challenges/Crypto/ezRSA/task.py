from Crypto.Util.number import *

flag = bytes_to_long(xxxxx)
p,q,r = getPrime(2048),getPrime(2048),getPrime(2048)
n = p * q * r
e = 0x10001

s = getPrime(300)
print(160 * s ** 5 - 4999 * s ** 4 + 3 * s ** 3 +1)

gift = (pow(p, (q-1)*(r-1)*q*r, (q*r) ** 3)* pow(q*r+1, q, (q*r)**3)) % (q*r)**3
print(gift)

phi = (p-1)*(q-1)*(r-1)
d = inverse(e,phi)
k = (p-s)*d
enc = pow(flag,e,n)
print(n)
print(k)
print(enc)

'''
2034324732495484527271326648264363832432019085176906369400995629590813377636685491145735369195442424540861519869848697139877795792719688366320904262945619042925136256863161005997244326203592289032375254549895986813362427744415267948474242075064613552597148522843157295972913918030691059852518534926511660794984167497876919410349603505973131815413029138776259177035704839417711286893525297932372114011908375566351923679018386971863796083830329957855513893
264538642078817426697928935494109369091100765669708256343339239746327661961054495338323044973861383442460356074469769048318331151491693455787475438857379532215186540369681225919872845326312982290870668804275531429568972541597897346334080748720408740020226527282094900804427566211661902761579056579841347129798501960394833757887596880264320099770915639882613669683823270058300314518476211534354107532616412334970025586214844535446894584275240578696579120887177522531082032306251090401223919859196445061179033562556885731046934060186430337541296264775301284795426781405636246952402678269837902667967940409589470749890015917841677791541741919239967329670534490765713034250333876219147243955238159111536772071572381643551365878208973458158180535344378216264872296430840318567285527224529280779573833968605898871982424168035291584573620251754840530466438462200350151894316226316806763578034744947351074412949491876090043528304132453695442770954311558704165350370902849030078730844075268205143993503876133205733288091330224937394414638438466288390343045525150663541253109445639546761907076760555313527195616308927577174518199559691028618095268123553133489217706402660560567362638953211564314107466005803441345158863073730538137222359034055149434395880718411878853735380852282957823824074553440991388413033593705455372139699844560804052138453869163879635998690059695465331464026584733954071099083129945135923272143827317962721746173403093159324877738883074637071812105277007416119734384965962010483950030054134628817163734391504391668622725636043103736757664917288081792381352233747198863107489250618843284668300519224414350717273498384292204442834010927504724528885153910278143636385387106982541405865879392237850266849008683188085575657517128082046108809334810685448881691979594554572400573702076298785363210936415014025014717675547707977989688555183301910196904743494765187553180689532254161276753853857735454936613570872304235528882218328198909448495399173705205498524577619281778150008574202886486993761025249213139581006381438489110309454282751453819388629809229558379788681817196485798256890246649193460368238018386176487964323942320351884974506951516526531590672928047180012517699640611143176018704400272526967995618325791881491645444944234429889635320473410296241742953286270932577282359841811235797829402602484669104519221518351769118214107702767391939093509839615943887043690632796616259135926941722974414380968079150312541177620340561105754587598829533078281539017642854088276824137924786580465367741893562352968746880085394732741704828798820789893558442367201101648181612358834108686684137516181289341539682120590415663670521938931056187481117181327386723131168085258211424550525782485532766575843037148856337613643171617197129019519129006682085869598620722413122591445820366297976185295098524555455686521948570483883854144885779773967693971493781062985065150734236334890823411210478767056435937755854343216494824706914761070963720739540186726865264132260938391925127652798636827808055476292765027414632476269029308018212266796224968563849236144068944762704311876207377643615588747904655949454108993793049138572173584936652557115607359959534796654365479281278496690731307392238827302912788233496281910777459761340125924768868742763861666251325401148558987119905538412299634644749362488793850433209977382283162489965034861480071188148403652086059936853519833443371988283066129208687060469587424817203644333750342276607550942095453195833103798687484676167580837109095114877283923618562027655203928397032166795242677016996475709061676417869299716702716381677710451168039322578089652354946178111644964419836243503083959740881242272603615138286786157945832086379417600047320277390122999819251550561
14733131394763854324801736395460194491676306639665026418887576200503251059236644134261117619135520761144081847183833136533608552521463945214005555978752034071442168490091275991499959406404073494873772549172349737926696209852128449573911317883227774809034639400853743050240028566809743487927049386967427077767575509135527003909254380186209685231624024444284280426118403612513361144208283953432564705981498736581845668573945569535634425302702606238030492145090485605859647081945710464832753900405302764564449963709768024801952759292594427479421369795673893680685388969982848915648722021386801706987803231656237750755186427322037150557311621725139260871613565575785013222175963107050725351647743995691153312953905764968159679084062183442811412358968503100681073113098539029731235026687415969311024215606151214218875860443005772356846039108370759175821838817394885970591998524036933462495928280660300815916825104394483688206925786058977693515290527323786473385552418497260292589485972946966521758268792703048184124531465839419130137157833420728214958156198598849279610427947620245293637630669971527038083179450310859241147294555690690954510363718732413762556970404340373340656969161601362926040252636605117732366908820527370798436080645190858138749034908117755519788225308168904854591176909671983702350880234310638881842440970349469132857473101373909492937045147214313750715546800973221019305591717665277731425354581669130640798834899606084332136424593619021233704551559788114826413087863140805626777510289777643075905434947517920648948713834962189337267876441624586849725703846641302808478777803739879430026643677048884347519645990202909516249645752006104829297836745720653274358196473628223323106258112622358571412237480400213380841237135111978808139274852493316926911687237030866220282759807111312449570652128112714405674339488483021376127332175964593
166851249658446875412118520562112094009218741427949455022450544199444917632804024460404660201607397175092065468285797607386924970642639345521943887458654134881099888480475268521280937476446582586826406337224344838100938223497274008880073160260015642977220086102849116227699957847561036648700146535314346703972058633880630868898547507583642707080250612943422781240909095212219397549462503817218958389279543836192796790477501726350795505247047645709568397495124364912887367625545307874016585368829721404314319063606753540680585022202027444907653729176870656781124847265175633347622307570637230972495545755122820489209698490913929610846299165255334992271006698449688394044839611790470031017144413675249311924274727653149666125345819278167310154761929335468570028211828686289078075614233302277655432557804435007389627580256625243332004350166965136132131427786936245461429591482661633853424540286145770732522044804340409283102625483789948752047042413445659422880334211930665767297322136551656182477896053975217141294244955931025241662451907113118500973292420204778096076735006725873355292642153227258783269519242599119140341059896992827968925492485398352384375872791549217300691199167339232615839679087331618498985176596242830368278594898286860442268127077515555776604841305736048998639163750157459296187545816167029478996802256740580134136952017323797028791323843077941864785666373763954422770721521703544158336364525195257408956603092022124375800860804947765808792766878272548161586510188119673084890236620197339209818914910434103179712319782195111960035071743519639271248884805006298462972511799153141649046862225500937824206273637112067634192476418592892557980778384703022601754720251738289469695642702551426974268365043897176132571929273806999266366991844913728012776616099622373424199051850986662550413475603552247924247099522630002596364368513505826600253953384547738554272428710752293319708342375554485507526481557469175731611940606494813078487544322433001872423957603398448676933869432470468634453063400021197354817620321604222080508880603762772101720026891647195695550358691309504302659716893491521387725546658010985136994997304775486894216799101593698930227025697769668464430322375671242364308704053533514958413063110469500058987753470004484869012219413378215134853691275455244183833126732993438080628733017608430403081779340295704930383557299670371326896888967717198793621263585115068028781217631520923227448503176673807459537016482635342403748668325914502800
5707218040333344302403261655546668722099748426779144537936348774092993349727998513751416884434796525658639465226479635422545851863133389037296460138627848781142418501836423198072890401052584123206053743303147946370590981492437765809211664823047371644385424389920163538804508811345140660279834156911973460017084654512275934599729472581717935298034512324194807306281132666728945494245189659203729443653430687024216292392882485053404574159800739235653230438432267985916317442890144281446614215220664376287570916851968251114530752189468928659007453703882704384233845339626403681917996905055874366888667001052407896835629387394144984104504728514662311591368101514655614133890081168220064540820335865256180316347878245981462963132328121487568378583378901571565067074864705626220414751890992269103379034097175610730997185097226584206897214014818181306651230923858641695931095588299526251795776562424213669629526749319954484065717419993314283167895749383210290655439082238095306248956895188986237712038062051770847717624081585653116896454317671411716594887956215629199027419580075717387193174428341494842535703034249343803544775181607737203671914711755572080448247442426762471020863045573508998134322983278372653222122101557283095775120183149522478096273795040350939852149352652243953736029302994598770064331220823144856075263032123407575786795474977550952269081506095057995504249425178659756484080441313583795310072414226380042557758712881574777618530587601037106539997289129714185905714787196861675724321796935186107538802131612301033782873572157472148810129032513146613473924912060237180029652039705342959706481811382110287373069667106872203620930510289289644829013512255215873270428345493466227789700273647641086859651211944094590800668832159110355967327106156839665441091282303534035421686852472084917481319414993084184134643452290073940555461605323135
'''